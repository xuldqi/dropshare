# DropShare Chrome扩展 - 服务器配置说明

## 如何配置线上服务器

### 方法1: 通过扩展设置（推荐）

1. **打开扩展设置**
   - 点击扩展图标
   - 点击右上角的"⚙️ 设置"按钮

2. **输入服务器地址**
   - 在"服务器地址"输入框中输入你的服务器WebSocket地址
   - 格式：`ws://域名:端口/server/webrtc` 或 `wss://域名/server/webrtc`

3. **保存设置**
   - 点击"保存"按钮
   - 扩展会自动重新连接到新服务器

### 方法2: 服务器地址格式

#### HTTP服务器（开发环境）
```
ws://localhost:8080/server/webrtc
ws://192.168.1.100:8080/server/webrtc
```

#### HTTPS服务器（生产环境）
```
wss://dropshare.tech/server/webrtc
wss://your-domain.com/server/webrtc
```

### 服务器地址示例

如果你的服务器是：
- **域名**: `dropshare.tech`
- **端口**: `8080` (HTTP) 或 `443` (HTTPS)
- **协议**: HTTPS

那么WebSocket地址应该是：
```
wss://dropshare.tech/server/webrtc
```

如果你的服务器是：
- **IP地址**: `123.456.789.0`
- **端口**: `8080`
- **协议**: HTTP

那么WebSocket地址应该是：
```
ws://123.456.789.0:8080/server/webrtc
```

## 重要提示

### 1. 协议选择
- **HTTP服务器** → 使用 `ws://`
- **HTTPS服务器** → 使用 `wss://` (WebSocket Secure)

### 2. 路径格式
服务器地址必须包含 `/server/webrtc` 路径，这是DropShare服务器的WebSocket端点。

### 3. 端口号
- HTTP默认端口：80（通常省略）
- HTTPS默认端口：443（通常省略）
- 自定义端口：需要明确指定，如 `:8080`

### 4. 完整示例

```
✅ 正确格式:
wss://dropshare.tech/server/webrtc
ws://192.168.1.100:8080/server/webrtc
wss://your-domain.com:8443/server/webrtc

❌ 错误格式:
wss://dropshare.tech                    (缺少路径)
ws://dropshare.tech:8080                (缺少路径)
https://dropshare.tech/server/webrtc    (应该用wss://)
```

## 验证连接

配置完成后：
1. 查看状态栏，应该显示"已连接到服务器"
2. 设备列表应该显示其他在线设备
3. 如果显示"与服务器断开连接"，检查：
   - 服务器地址是否正确
   - 服务器是否正在运行
   - 防火墙是否允许WebSocket连接
   - 网络连接是否正常

## 常见问题

### Q: 如何知道我的服务器地址？
A: 
- 如果你有域名，使用：`wss://你的域名/server/webrtc`
- 如果你有IP地址，使用：`ws://IP地址:端口/server/webrtc`
- 如果是本地开发，使用：`ws://localhost:8080/server/webrtc`

### Q: 为什么连接失败？
A: 检查以下几点：
1. 服务器地址格式是否正确
2. 服务器是否正在运行
3. 防火墙是否阻止了WebSocket连接
4. 网络连接是否正常
5. 查看扩展的Service Worker日志（chrome://extensions/ → 找到扩展 → 点击"service worker"）

### Q: 可以同时连接多个服务器吗？
A: 不可以，扩展一次只能连接一个服务器。如果需要切换，在设置中修改服务器地址。

### Q: 设置保存在哪里？
A: 设置保存在Chrome的同步存储中，会在你的Chrome账户中同步。

## 测试连接

配置服务器地址后，可以：
1. 打开扩展popup
2. 查看状态栏
3. 如果显示"已连接到服务器"，说明配置成功
4. 如果显示"与服务器断开连接"，检查服务器地址和网络连接

## 需要帮助？

如果遇到问题：
1. 查看浏览器控制台日志
2. 查看扩展的Service Worker日志
3. 检查服务器日志
4. 确认服务器WebSocket端点是否正确


