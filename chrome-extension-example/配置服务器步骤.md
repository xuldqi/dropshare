# 配置DropShare服务器地址 - 详细步骤

## 🎯 确定你的服务器地址

### 方法1: 自动检测（最简单）⭐

1. **打开你的DropShare网站**
   - 在浏览器中访问你的DropShare网站
   - 例如：`https://your-domain.com` 或 `http://your-ip:8080`

2. **打开扩展设置**
   - 点击Chrome工具栏中的DropShare扩展图标
   - 点击右上角的"⚙️ 设置"按钮

3. **自动检测**
   - 点击"🔍 点击自动检测（需先打开DropShare网站）"
   - 服务器地址会自动填充到输入框

4. **保存设置**
   - 点击"保存"按钮
   - 扩展会自动重新连接到服务器

### 方法2: 手动输入

如果你知道你的服务器地址：

1. **打开扩展设置**
   - 点击扩展图标
   - 点击"⚙️ 设置"按钮

2. **输入服务器地址**
   - 格式：`ws://域名:端口/server/webrtc` 或 `wss://域名/server/webrtc`
   - 示例：
     - `wss://dropshare.tech/server/webrtc`
     - `ws://192.168.1.100:8080/server/webrtc`

3. **保存设置**
   - 点击"保存"按钮

### 方法3: 使用检测脚本

在你的DropShare网站上：

1. **打开浏览器控制台** (按F12)
2. **切换到Console标签页**
3. **运行检测脚本** (复制 `detect-server-url.js` 中的代码并运行)
4. **查看输出的服务器地址**
5. **复制地址到扩展设置中**

## 📝 服务器地址格式说明

### HTTPS网站
- 网站地址：`https://your-domain.com`
- WebSocket地址：`wss://your-domain.com/server/webrtc`

### HTTP网站
- 网站地址：`http://your-domain.com:8080`
- WebSocket地址：`ws://your-domain.com:8080/server/webrtc`

### 本地开发
- 网站地址：`http://localhost:8080`
- WebSocket地址：`ws://localhost:8080/server/webrtc`

## ⚠️ 重要提示

1. **协议转换**
   - `https://` → `wss://` (WebSocket Secure)
   - `http://` → `ws://` (WebSocket)

2. **路径必须包含**
   - 地址末尾必须是 `/server/webrtc`
   - 这是DropShare服务器的WebSocket端点

3. **端口号**
   - HTTPS默认443（通常省略）
   - HTTP默认80（通常省略）
   - 自定义端口需要明确指定

## ✅ 验证配置

配置后检查：

1. **查看状态栏**
   - ✅ "已连接到服务器"（绿色）→ 配置成功
   - ❌ "与服务器断开连接"（红色）→ 检查地址和网络

2. **查看设备列表**
   - 如果显示其他在线设备，说明配置正确

3. **查看日志**
   - 打开 `chrome://extensions/`
   - 找到DropShare扩展
   - 点击"service worker"
   - 查看Console中的连接日志

## 🔍 常见问题

### Q: 如何知道我的服务器域名？
A: 
- 查看你的DropShare网站地址栏
- 查看服务器配置文档
- 查看服务器环境变量
- 询问服务器管理员

### Q: 如何知道服务器端口？
A:
- HTTPS默认443（通常省略）
- HTTP默认80（通常省略）
- 查看服务器配置或启动日志
- 查看docker-compose.yml或.env文件

### Q: 连接失败怎么办？
A:
1. 检查服务器地址格式是否正确
2. 检查服务器是否正在运行
3. 检查防火墙设置
4. 检查网络连接
5. 查看扩展的Service Worker日志

## 💡 快速参考

**转换规则：**
```
网站地址 → WebSocket地址
https://domain.com → wss://domain.com/server/webrtc
http://domain.com:8080 → ws://domain.com:8080/server/webrtc
```

**测试连接：**
- 使用浏览器控制台测试脚本
- 查看扩展Service Worker日志
- 检查网络请求


