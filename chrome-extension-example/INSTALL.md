# DropShare Chrome扩展 - 安装指南

## 前置要求

1. **Chrome浏览器** (版本88或更高)
2. **DropShare服务器运行中** (默认: `localhost:8080`)
3. **两个或更多设备** (在同一局域网内)

## 安装步骤

### 方法1: 开发模式安装（推荐用于测试）

1. **下载扩展文件**
   - 将 `chrome-extension-example` 文件夹复制到本地

2. **打开Chrome扩展管理页面**
   - 在地址栏输入: `chrome://extensions/`
   - 或通过菜单: 更多工具 → 扩展程序

3. **启用开发者模式**
   - 在扩展管理页面右上角，打开"开发者模式"开关

4. **加载扩展**
   - 点击"加载已解压的扩展程序"
   - 选择 `chrome-extension-example` 文件夹
   - 点击"选择文件夹"

5. **确认安装**
   - 扩展应该出现在扩展列表中
   - 确保扩展已启用（开关为蓝色）

### 方法2: 从Chrome Web Store安装（待发布）

1. 访问 Chrome Web Store
2. 搜索 "DropShare"
3. 点击"添加至Chrome"
4. 确认安装

## 配置服务器

### 默认配置
扩展默认连接到 `ws://localhost:8080/server/webrtc`

### 自定义服务器地址
1. 点击扩展图标
2. 点击"设置"按钮（如果已添加）
3. 输入服务器WebSocket地址
4. 保存设置

**服务器地址格式:**
- WebSocket (WS): `ws://your-server.com:8080/server/webrtc`
- WebSocket Secure (WSS): `wss://your-server.com/server/webrtc`

## 创建图标文件

扩展需要图标文件才能正常显示。创建以下图标：

1. **创建icons文件夹**
   ```bash
   mkdir chrome-extension-example/icons
   ```

2. **准备图标文件**
   - `icon16.png` - 16x16像素
   - `icon48.png` - 48x48像素  
   - `icon128.png` - 128x128像素

3. **图标设计建议**
   - 使用DropShare的Logo
   - 或者使用简单的文件传输图标
   - 确保在不同尺寸下都清晰可见

**快速创建图标的方法:**
- 使用在线图标生成器
- 使用图像编辑软件
- 使用SVG转PNG工具

## 使用方法

### 发送文件

1. **打开扩展**
   - 点击浏览器工具栏中的DropShare图标

2. **选择目标设备**
   - 在设备列表中选择要发送文件到的设备
   - 设备显示为绿色圆点表示在线

3. **选择文件**
   - 点击"选择文件"按钮
   - 选择一个或多个文件

4. **发送文件**
   - 点击"发送文件"按钮
   - 等待传输完成

### 接收文件

1. **保持扩展运行**
   - 扩展会在后台运行
   - 收到文件时会显示通知

2. **确认接收**
   - 点击通知查看文件详情
   - 文件会自动保存到下载文件夹

## 故障排除

### 问题1: 无法连接到服务器

**解决方案:**
- 检查DropShare服务器是否运行
- 检查服务器地址是否正确
- 检查防火墙设置
- 查看扩展的控制台日志（右键扩展 → 检查弹出式窗口 → Console）

### 问题2: 无法发现其他设备

**解决方案:**
- 确保所有设备都在同一局域网
- 确保所有设备都安装了扩展
- 确保所有设备都连接到服务器
- 等待几秒钟让设备列表刷新

### 问题3: 文件传输失败

**解决方案:**
- 检查WebRTC连接是否建立
- 检查网络连接
- 检查文件大小是否超出限制
- 查看浏览器控制台错误信息

### 问题4: 扩展无法加载

**解决方案:**
- 检查manifest.json格式是否正确
- 检查所有文件是否都在正确位置
- 检查图标文件是否存在
- 查看扩展管理页面的错误信息

## 开发调试

### 查看Background Service Worker日志

1. 打开 `chrome://extensions/`
2. 找到DropShare扩展
3. 点击"service worker"链接
4. 查看Console标签页

### 查看Popup日志

1. 右键点击扩展图标
2. 选择"检查弹出式窗口"
3. 查看Console标签页

### 查看网络请求

1. 打开开发者工具 (F12)
2. 切换到Network标签页
3. 过滤WebSocket连接
4. 查看消息传输

## 测试 checklist

- [ ] 扩展成功安装
- [ ] 可以连接到服务器
- [ ] 可以显示设备列表
- [ ] 可以选择文件
- [ ] 可以发送文件
- [ ] 可以接收文件
- [ ] 传输进度正常显示
- [ ] 文件完整接收
- [ ] 通知正常显示
- [ ] 多文件传输正常

## 常见问题

### Q: 支持哪些文件类型？
A: 支持所有文件类型，没有限制。

### Q: 最大文件大小是多少？
A: 理论上没有限制，但受浏览器内存限制。建议单文件不超过2GB。

### Q: 是否支持跨网络传输？
A: 支持，但需要服务器支持。局域网内传输更快。

### Q: 是否安全？
A: 文件传输使用WebRTC，数据不经过服务器（除了信令）。但仍建议只传输非敏感文件。

### Q: 是否支持断点续传？
A: 当前版本不支持，未来版本可能会添加。

## 技术支持

如果遇到问题，请：
1. 查看控制台日志
2. 检查服务器日志
3. 查看GitHub Issues
4. 提交Bug报告

## 更新日志

### v1.0.0 (当前版本)
- 初始版本
- 支持基本的文件传输
- 支持设备发现
- 支持进度显示
- 支持通知

## 下一步

- [ ] 添加设置页面
- [ ] 添加传输历史
- [ ] 添加文件加密
- [ ] 添加断点续传
- [ ] 优化大文件传输
- [ ] 添加拖拽支持
- [ ] 添加多语言支持


