<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOCX to TXT Converter</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link rel="stylesheet" type="text/css" href="styles/file-converter.css">
    <link rel="stylesheet" type="text/css" href="styles/ui-ux-enhancements.css">
    <style>
        body {
            padding: 20px;
            background: var(--bg-color);
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            color: var(--primary-color);
            text-decoration: none;
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .page-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .converter-container {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 30px;
        }
        
        .tool-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .tool-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }
        
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: var(--primary-color);
            background: var(--bg-color-secondary);
        }
        
        .upload-area.dragover {
            border-color: var(--primary-color);
            background: var(--bg-color-secondary);
        }
        
        .upload-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .file-info {
            display: none;
            background: var(--bg-color-secondary);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .file-details {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .file-icon {
            font-size: 2em;
        }
        
        .conversion-options {
            display: none;
            margin-bottom: 30px;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .option-card {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
        }
        
        .option-card label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }
        
        .conversion-progress {
            display: none;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .progress-bar {
            background: var(--bg-color-secondary);
            border-radius: 20px;
            height: 8px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: var(--primary-color);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .conversion-result {
            display: none;
            background: var(--bg-color-secondary);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
        }
        
        .result-preview {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            text-align: left;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-color-dark);
        }
        
        .btn-secondary {
            background: var(--surface-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background: var(--bg-color-secondary);
        }
        
        .features-info {
            background: var(--bg-color-secondary);
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-item {
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        /* Device Modal Styles */
        .device-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .device-modal-content {
            background: var(--surface-color);
            border-radius: 12px;
            padding: 0;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
        }
        
        .device-modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .device-modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
        }
        
        .device-list {
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .device-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .device-item:hover {
            background: var(--bg-color-secondary);
        }
        
        .device-item.selected {
            background: var(--primary-color-light);
            border: 1px solid var(--primary-color);
        }
        
        .device-modal-actions {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-btn-cancel {
            background: var(--surface-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .modal-btn-send {
            background: var(--primary-color);
            color: white;
        }
        
        .modal-btn-send:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
        }
    </style>
    <link rel="stylesheet" href="share-integration.css">
    <link rel="stylesheet" href="device-selector.css">
    <script src="/locales/i18n.js"></script>
</head>
<body>
<!-- Unified Header Template -->
<!-- å¤åˆ¶è¿™ä¸ªheaderåˆ°æ‰€æœ‰é¡µé¢ï¼Œæ›¿æ¢ç°æœ‰çš„header -->
<!-- Unified Header Template -->
<!-- å¤åˆ¶è¿™ä¸ªheaderåˆ°æ‰€æœ‰é¡µé¢ï¼Œæ›¿æ¢ç°æœ‰çš„header -->
<!-- Unified Header Template -->
<!-- å¤åˆ¶è¿™ä¸ªheaderåˆ°æ‰€æœ‰é¡µé¢ï¼Œæ›¿æ¢ç°æœ‰çš„header -->
<!-- Unified Header Template -->
<!-- å¤åˆ¶è¿™ä¸ªheaderåˆ°æ‰€æœ‰é¡µé¢ï¼Œæ›¿æ¢ç°æœ‰çš„header -->
<!-- Unified Header Template -->
<!-- å¤åˆ¶è¿™ä¸ªheaderåˆ°æ‰€æœ‰é¡µé¢ï¼Œæ›¿æ¢ç°æœ‰çš„header -->
<header class="header">
    <div class="header-container">
        <div class="header-controls">
            <div class="brand-left">
                <button class="hamburger" id="hamburgerBtn" aria-label="Open Menu"><span></span></button>
                <div class="logo">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M12 11c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 2c0-3.31-2.69-6-6-6s-6 2.69-6 6c0 2.22 1.21 4.15 3 5.19l1-1.74c-1.19-.7-2-1.97-2-3.45 0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.48-.81 2.75-2 3.45l1 1.74c1.79-1.04 3-2.97 3-5.19zM12 3C6.48 3 2 7.48 2 13c0 3.7 2.01 6.92 4.99 8.65l1-1.73C5.61 18.53 4 15.96 4 13c0-4.42 3.58-8 8-8s8 3.58 8 8c0 2.96-1.61 5.53-4 6.92l1 1.73c2.99-1.73 5-4.95 5-8.65 0-5.52-4.48-10-10-10z" />
                    </svg>
                    <a href="index.html" style="text-decoration: none; color: inherit;"
                        data-i18n="site_name">DropShare</a>
                </div>
            </div>
            <!-- Navigation removed to match index.html -->
            <div class="control-buttons"
                style="min-width: 140px; display: flex; justify-content: flex-end; position: relative;">
                <div class="language-selector" id="languageSelector">
                    <button id="langToggle" aria-haspopup="listbox" aria-expanded="false"
                        style="display:none;">Language</button>
                    <select id="language-selector"
                        style="padding: 6px 12px; border: 1px solid #d1d5db; border-radius: 6px; background: white; color: #374151; font-size: 14px;">
                        <option value="en">English</option>
                        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                        <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                        <option value="ja">æ—¥æœ¬èª</option>
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="fr">FranÃ§ais</option>
                        <option value="de">Deutsch</option>
                        <option value="pt">PortuguÃªs</option>
                        <option value="es">EspaÃ±ol</option>
                    </select>
                    <div class="lang-menu" id="langMenu" role="listbox" aria-label="Select language"></div>
                </div>
            </div>
        </div>
    </div>
</header>

<style>
    /* PREMIUM THEME OVERRIDES (Diafano Style) */
    :root {
        --primary-50: #F4F8FB;
        --primary-100: #E6EEF5;
        --primary-500: #5B84B1;
        /* Premium Muted Blue */
        --primary-600: #4a6f96;
        --gray-50: #F9FAFB;
        --gray-100: #F3F4F6;
        --gray-900: #2C3E50;
        --success: #10B981;
    }

    /* Force font family */
    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !important;
        background-color: #FDFDFD !important;
        color: var(--gray-900) !important;
    }

    /* Unified Header Styles */
    .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e5e7eb;
        z-index: 3000;
        padding: 12px 0;
    }

    .header-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .brand-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 24px !important;
        font-weight: 700 !important;
        color: var(--primary-600) !important;
        text-decoration: none !important;
    }

    .logo a {
        color: var(--primary-600) !important;
        text-decoration: none !important;
    }

    .logo svg {
        width: 32px !important;
        height: 32px !important;
        fill: var(--primary-500) !important;
    }

    /* CARD STYLING */
    .converter-card,
    .tool-card,
    .container>div[class*="card"] {
        border-radius: 24px !important;
        box-shadow: 0 20px 40px -10px rgba(91, 132, 177, 0.1) !important;
        border: 1px solid var(--primary-100) !important;
        background: white !important;
        padding: 40px !important;
    }

    /* UPLOAD AREA */
    .upload-area {
        border: 2px dashed var(--primary-100) !important;
        border-radius: 16px !important;
        background: var(--gray-50) !important;
        transition: all 0.3s ease !important;
    }

    .upload-area:hover {
        border-color: var(--primary-500) !important;
        background: #fff !important;
        transform: translateY(-2px);
    }

    .upload-icon {
        color: var(--primary-500) !important;
    }

    /* BUTTONS */
    .convert-button,
    .btn-primary,
    button[type="submit"],
    .modal-btn-send {
        border-radius: 50px !important;
        box-shadow: 0 10px 25px -5px rgba(91, 132, 177, 0.25) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        text-transform: capitalize !important;
        letter-spacing: 0.5px !important;
        padding: 14px 40px !important;
        background: var(--primary-500) !important;
        border: none !important;
        font-weight: 600 !important;
        color: white !important;
    }

    .convert-button:hover,
    .btn-primary:hover,
    button[type="submit"]:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 15px 30px -5px rgba(91, 132, 177, 0.35) !important;
        background: var(--primary-600) !important;
    }

    .btn-secondary,
    .modal-btn-cancel,
    button[id*="reset"] {
        border-radius: 50px !important;
        background: var(--primary-50) !important;
        color: var(--primary-600) !important;
        border: none !important;
        padding: 12px 24px !important;
        font-weight: 600 !important;
    }

    .btn-secondary:hover {
        background: var(--primary-100) !important;
    }

    /* FORMAT OPTIONS */
    .format-option {
        border-radius: 12px !important;
        transition: all 0.2s ease !important;
        border: 1px solid var(--gray-100) !important;
    }

    .format-option:hover {
        border-color: var(--primary-500) !important;
        background: var(--primary-50) !important;
    }

    .format-option.selected {
        border-color: var(--primary-500) !important;
        background: var(--primary-500) !important;
        color: white !important;
        box-shadow: 0 8px 16px -4px rgba(91, 132, 177, 0.3) !important;
    }

    .format-option.selected .format-desc {
        color: rgba(255, 255, 255, 0.9) !important;
    }

    /* TITLES */
    .page-title {
        color: var(--gray-900) !important;
        font-weight: 800 !important;
        letter-spacing: -0.02em !important;
    }

    .page-subtitle {
        color: var(--text-muted) !important;
    }

    .header-controls {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        /* Changed to flex-end to push Lang right */
        width: 100%;
    }

    .control-buttons {
        display: flex;
        gap: 8px;
        align-items: center;
        justify-content: flex-end;
    }

    /* Hamburger */
    .hamburger {
        display: none;
    }

    /* Language Selector */
    .language-selector select {
        border: 1px solid var(--gray-100) !important;
        border-radius: 50px !important;
        /* Pill shape for premium feel */
        padding: 8px 16px !important;
        font-size: 13px !important;
        color: var(--gray-900) !important;
        background-color: white !important;
        cursor: pointer;
        outline: none !important;
    }

    .language-selector select:hover {
        border-color: var(--primary-500) !important;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .header-container {
            padding: 0 16px;
        }

        .hamburger {
            display: flex !important;
            border: none !important;
            background: transparent !important;
        }

        .hamburger span {
            background: var(--gray-900) !important;
        }

        /* Mobile Menu styling could go here if navigation existed */
    }
</style>

<style>
    /* Unified Header Styles */
    .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e5e7eb;
        z-index: 3000;
        padding: 12px 0;
    }

    .header-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .brand-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 24px !important;
        font-weight: bold !important;
        color: #4a6f96 !important;
        /* Matching index.html --primary-600 */
        text-decoration: none !important;
    }

    .logo a {
        color: #4a6f96 !important;
        text-decoration: none !important;
    }

    .logo svg {
        width: 32px !important;
        height: 32px !important;
        fill: #5B84B1 !important;
        /* Matching index.html --primary-500 */
    }

    /* Tool Page Optimizations (Diafano Style) */
    .convert-button,
    .btn-primary,
    button[type="submit"] {
        border-radius: 50px !important;
        box-shadow: 0 10px 25px -5px rgba(91, 132, 177, 0.25) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        text-transform: capitalize !important;
        letter-spacing: 0.5px !important;
        padding: 12px 32px !important;
        background: #3367d6 !important;
        /* Keep tool button blue, or use #5B84B1 */
        border: none !important;
    }

    .convert-button:hover,
    .btn-primary:hover,
    button[type="submit"]:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 15px 30px -5px rgba(91, 132, 177, 0.35) !important;
    }

    .format-option {
        border-radius: 12px !important;
        transition: all 0.2s ease !important;
    }

    .format-option:hover {
        border-color: #5B84B1 !important;
        background: #F4F8FB !important;
    }

    .format-option.selected {
        border-color: #5B84B1 !important;
        background: #5B84B1 !important;
    }

    .header-controls {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
    }

    /* æ¡Œé¢ç«¯å¯¼èˆªé“¾æ¥å±…ä¸­ */
    .nav-links {
        display: flex;
        gap: 24px;
        align-items: center;
        flex: 1;
        justify-content: center;
        margin: 0 20px !important;
    }

    .nav-links a {
        color: #6b7280 !important;
        text-decoration: none !important;
        font-weight: 500 !important;
        font-size: 14px !important;
        padding: 8px 16px !important;
        border-radius: 6px !important;
        transition: all 0.2s ease !important;
        background: transparent !important;
    }

    .nav-links a:hover {
        color: #5B84B1 !important;
        background: #f3f4f6 !important;
    }

    .nav-links a.active {
        color: #5B84B1 !important;
        background: #e3f2fd !important;
        font-weight: 600 !important;
    }

    .control-buttons {
        display: flex;
        gap: 8px;
        align-items: center;
        min-width: 140px;
        justify-content: flex-end;
    }

    /* Hamburger (hidden on desktop) */
    .hamburger {
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 40px;
        height: 40px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        cursor: pointer;
        padding: 4px;
    }

    .hamburger span {
        width: 18px;
        height: 2px;
        background: #374151;
        transition: all 0.3s ease;
        border-radius: 1px;
        margin: 2px 0;
    }

    /* Language Selector */
    .language-selector {
        position: relative;
    }

    .language-selector select {
        cursor: pointer;
    }

    /* Mobile Responsive */
    @media (min-width: 769px) {
        .header {
            display: block;
        }

        .hamburger {
            display: none;
        }

        .nav-links {
            display: flex !important;
        }
    }

    @media (max-width: 768px) {
        .header {
            display: block;
        }

        .header-container {
            padding: 0 16px;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        .hamburger {
            display: flex !important;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e5e7eb;
            border-radius: 10px;
        }

        /* ç§»åŠ¨ç«¯éšè—å¯¼èˆªé“¾æ¥ï¼Œé€šè¿‡æ±‰å ¡èœå•æ˜¾ç¤º */
        .nav-links {
            display: none !important;
        }

        .nav-links.mobile-open {
            display: flex !important;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px;
            z-index: 999;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .nav-links a {
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        /* å“ç‰ŒåŒºåŸŸåªæ˜¾ç¤ºæ±‰å ¡èœå•ï¼Œéšè—logoæ–‡å­— */
        .brand-left .logo a {
            display: none;
        }

        /* è¯­è¨€é€‰æ‹©å™¨ä¿æŒåœ¨å³ä¾§ */
        .control-buttons {
            min-width: auto !important;
            justify-content: flex-end !important;
        }

        .menu-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            z-index: 2000;
            display: none;
            pointer-events: auto;
        }

        .menu-backdrop.show {
            display: block;
        }
    }

    /* Mobile: hide header logo icon in navigation to save space */
    @media (max-width: 768px) {
        .header .logo svg {
            display: none;
        }
    }
</style>

<style>
    /* Unified Header Styles */
    .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e5e7eb;
        z-index: 3000;
        padding: 12px 0;
    }

    .header-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .brand-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 24px !important;
        font-weight: bold !important;
        color: #4a6f96 !important;
        /* Matching index.html --primary-600 */
        text-decoration: none !important;
    }

    .logo a {
        color: #4a6f96 !important;
        text-decoration: none !important;
    }

    .logo svg {
        width: 32px !important;
        height: 32px !important;
        fill: #5B84B1 !important;
        /* Matching index.html --primary-500 */
    }

    /* Tool Page Optimizations (Diafano Style) */
    .convert-button,
    .btn-primary,
    button[type="submit"] {
        border-radius: 50px !important;
        box-shadow: 0 10px 25px -5px rgba(91, 132, 177, 0.25) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        text-transform: capitalize !important;
        letter-spacing: 0.5px !important;
        padding: 12px 32px !important;
        background: #3367d6 !important;
        /* Keep tool button blue, or use #5B84B1 */
        border: none !important;
    }

    .convert-button:hover,
    .btn-primary:hover,
    button[type="submit"]:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 15px 30px -5px rgba(91, 132, 177, 0.35) !important;
    }

    .format-option {
        border-radius: 12px !important;
        transition: all 0.2s ease !important;
    }

    .format-option:hover {
        border-color: #5B84B1 !important;
        background: #F4F8FB !important;
    }

    .format-option.selected {
        border-color: #5B84B1 !important;
        background: #5B84B1 !important;
    }

    .header-controls {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
    }

    /* æ¡Œé¢ç«¯å¯¼èˆªé“¾æ¥å±…ä¸­ */
    .nav-links {
        display: flex;
        gap: 24px;
        align-items: center;
        flex: 1;
        justify-content: center;
        margin: 0 20px !important;
    }

    .nav-links a {
        color: #6b7280 !important;
        text-decoration: none !important;
        font-weight: 500 !important;
        font-size: 14px !important;
        padding: 8px 16px !important;
        border-radius: 6px !important;
        transition: all 0.2s ease !important;
        background: transparent !important;
    }

    .nav-links a:hover {
        color: #5B84B1 !important;
        background: #f3f4f6 !important;
    }

    .nav-links a.active {
        color: #5B84B1 !important;
        background: #e3f2fd !important;
        font-weight: 600 !important;
    }

    .control-buttons {
        display: flex;
        gap: 8px;
        align-items: center;
        min-width: 140px;
        justify-content: flex-end;
    }

    /* Hamburger (hidden on desktop) */
    .hamburger {
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 40px;
        height: 40px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        cursor: pointer;
        padding: 4px;
    }

    .hamburger span {
        width: 18px;
        height: 2px;
        background: #374151;
        transition: all 0.3s ease;
        border-radius: 1px;
        margin: 2px 0;
    }

    /* Language Selector */
    .language-selector {
        position: relative;
    }

    .language-selector select {
        cursor: pointer;
    }

    /* Mobile Responsive */
    @media (min-width: 769px) {
        .header {
            display: block;
        }

        .hamburger {
            display: none;
        }

        .nav-links {
            display: flex !important;
        }
    }

    @media (max-width: 768px) {
        .header {
            display: block;
        }

        .header-container {
            padding: 0 16px;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        .hamburger {
            display: flex !important;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e5e7eb;
            border-radius: 10px;
        }

        /* ç§»åŠ¨ç«¯éšè—å¯¼èˆªé“¾æ¥ï¼Œé€šè¿‡æ±‰å ¡èœå•æ˜¾ç¤º */
        .nav-links {
            display: none !important;
        }

        .nav-links.mobile-open {
            display: flex !important;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px;
            z-index: 999;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .nav-links a {
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        /* å“ç‰ŒåŒºåŸŸåªæ˜¾ç¤ºæ±‰å ¡èœå•ï¼Œéšè—logoæ–‡å­— */
        .brand-left .logo a {
            display: none;
        }

        /* è¯­è¨€é€‰æ‹©å™¨ä¿æŒåœ¨å³ä¾§ */
        .control-buttons {
            min-width: auto !important;
            justify-content: flex-end !important;
        }

        .menu-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            z-index: 2000;
            display: none;
            pointer-events: auto;
        }

        .menu-backdrop.show {
            display: block;
        }
    }

    /* Mobile: hide header logo icon in navigation to save space */
    @media (max-width: 768px) {
        .header .logo svg {
            display: none;
        }
    }
</style>

<style>
    /* Unified Header Styles */
    .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e5e7eb;
        z-index: 3000;
        padding: 12px 0;
    }

    .header-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .brand-left {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 24px;
        font-weight: bold;
        color: #4a6f96;
        /* Matching index.html --primary-600 */
    }

    .logo svg {
        width: 32px;
        height: 32px;
        fill: #5B84B1;
        /* Matching index.html --primary-500 */
    }

    /* Tool Page Optimizations (Diafano Style) */
    .convert-button,
    .btn-primary,
    button[type="submit"] {
        border-radius: 50px !important;
        box-shadow: 0 10px 25px -5px rgba(91, 132, 177, 0.25) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        text-transform: capitalize !important;
        letter-spacing: 0.5px !important;
        padding: 12px 32px !important;
        background: #3367d6 !important;
        /* Keep tool button blue, or use #5B84B1 */
    }

    .convert-button:hover,
    .btn-primary:hover,
    button[type="submit"]:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 15px 30px -5px rgba(91, 132, 177, 0.35) !important;
    }

    .format-option {
        border-radius: 12px !important;
        transition: all 0.2s ease !important;
    }

    .format-option:hover {
        border-color: #5B84B1 !important;
        background: #F4F8FB !important;
    }

    .format-option.selected {
        border-color: #5B84B1 !important;
        background: #5B84B1 !important;
    }

    .header-controls {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
    }

    /* æ¡Œé¢ç«¯å¯¼èˆªé“¾æ¥å±…ä¸­ */
    .nav-links {
        display: flex;
        gap: 24px;
        align-items: center;
        flex: 1;
        justify-content: center;
    }

    .nav-links a {
        color: #6b7280;
        text-decoration: none;
        font-weight: 500;
        font-size: 14px;
        padding: 8px 16px;
        border-radius: 6px;
        transition: all 0.2s ease;
    }

    .nav-links a:hover {
        color: #5B84B1;
        background: #f3f4f6;
    }

    .nav-links a.active {
        color: #5B84B1;
        background: #e3f2fd;
        font-weight: 600;
    }

    .control-buttons {
        display: flex;
        gap: 8px;
        align-items: center;
        min-width: 140px;
        justify-content: flex-end;
    }

    /* Hamburger (hidden on desktop) */
    .hamburger {
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 40px;
        height: 40px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        cursor: pointer;
        padding: 4px;
    }

    .hamburger span {
        width: 18px;
        height: 2px;
        background: #374151;
        transition: all 0.3s ease;
        border-radius: 1px;
        margin: 2px 0;
    }

    /* Language Selector */
    .language-selector {
        position: relative;
    }

    .language-selector select {
        cursor: pointer;
    }

    /* Mobile Responsive */
    @media (min-width: 769px) {
        .header {
            display: block;
        }

        .hamburger {
            display: none;
        }

        .nav-links {
            display: flex !important;
        }
    }

    @media (max-width: 768px) {
        .header {
            display: block;
        }

        .header-container {
            padding: 0 16px;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        .hamburger {
            display: flex !important;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #e5e7eb;
            border-radius: 10px;
        }

        /* ç§»åŠ¨ç«¯éšè—å¯¼èˆªé“¾æ¥ï¼Œé€šè¿‡æ±‰å ¡èœå•æ˜¾ç¤º */
        .nav-links {
            display: none !important;
        }

        .nav-links.mobile-open {
            display: flex !important;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px;
            z-index: 999;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .nav-links a {
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        /* å“ç‰ŒåŒºåŸŸåªæ˜¾ç¤ºæ±‰å ¡èœå•ï¼Œéšè—logoæ–‡å­— */
        .brand-left .logo a {
            display: none;
        }

        /* è¯­è¨€é€‰æ‹©å™¨ä¿æŒåœ¨å³ä¾§ */
        .control-buttons {
            min-width: auto !important;
            justify-content: flex-end !important;
        }

        .menu-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            z-index: 2000;
            display: none;
            pointer-events: auto;
        }

        .menu-backdrop.show {
            display: block;
        }
    }

    /* Mobile: hide header logo icon in navigation to save space */
    @media (max-width: 768px) {
        .header .logo svg {
            display: none;
        }
    }
</style>

<style>
/* Unified Header Styles */
.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #e5e7eb;
    z-index: 3000;
    padding: 12px 0;
}

.header-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.brand-left { 
    display: flex; 
    align-items: center; 
    gap: 12px; 
}

.logo {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 24px;
    font-weight: bold;
    color: #2563eb;
}

.logo svg {
    width: 32px;
    height: 32px;
    fill: #2563eb;
}

.header-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
}

/* æ¡Œé¢ç«¯å¯¼èˆªé“¾æ¥å±…ä¸­ */
.nav-links {
    display: flex;
    gap: 24px;
    align-items: center;
    flex: 1;
    justify-content: center;
}

.nav-links a {
    color: #6b7280;
    text-decoration: none;
    font-weight: 500;
    font-size: 14px;
    padding: 8px 16px;
    border-radius: 6px;
    transition: all 0.2s ease;
}

.nav-links a:hover {
    color: #2563eb;
    background: #f3f4f6;
}

.nav-links a.active {
    color: #2563eb;
    background: #e3f2fd;
    font-weight: 600;
}

.control-buttons {
    display: flex;
    gap: 8px;
    align-items: center;
    min-width: 140px;
    justify-content: flex-end;
}

/* Hamburger (hidden on desktop) */
.hamburger {
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 40px;
    height: 40px;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    cursor: pointer;
    padding: 4px;
}

.hamburger span {
    width: 18px;
    height: 2px;
    background: #374151;
    transition: all 0.3s ease;
    border-radius: 1px;
    margin: 2px 0;
}

/* Language Selector */
.language-selector {
    position: relative;
}

.language-selector select {
    cursor: pointer;
}

/* Mobile Responsive */
@media (min-width: 769px) {
    .header {
        display: block;
    }
    
    .hamburger {
        display: none;
    }
    
    .nav-links {
        display: flex !important;
    }
}

@media (max-width: 768px) {
    .header {
        display: block;
    }
    
    .header-container {
        padding: 0 16px;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
    }
    
    .hamburger { 
        display: flex !important; 
        background: rgba(255,255,255,0.95);
        border: 1px solid #e5e7eb;
        border-radius: 10px;
    }
    
    /* ç§»åŠ¨ç«¯éšè—å¯¼èˆªé“¾æ¥ï¼Œé€šè¿‡æ±‰å ¡èœå•æ˜¾ç¤º */
    .nav-links { 
        display: none !important; 
    }
    
    .nav-links.mobile-open {
        display: flex !important;
        flex-direction: column;
        gap: 8px;
        width: 100%;
        position: fixed;
        top: 80px;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 20px;
        z-index: 999;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    
    .nav-links a {
        font-size: 14px;
        padding: 8px 12px;
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
    }
    
    /* å“ç‰ŒåŒºåŸŸåªæ˜¾ç¤ºæ±‰å ¡èœå•ï¼Œéšè—logoæ–‡å­— */
    .brand-left .logo a { 
        display: none; 
    }
    
    /* è¯­è¨€é€‰æ‹©å™¨ä¿æŒåœ¨å³ä¾§ */
    .control-buttons { 
        min-width: auto !important; 
        justify-content: flex-end !important; 
    }
    
    .menu-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.35);
        z-index: 2000;
        display: none;
        pointer-events: auto;
    }
    .menu-backdrop.show { display: block; }
}

/* Mobile: hide header logo icon in navigation to save space */
@media (max-width: 768px) {
    .header .logo svg { display: none; }
}
</style>

    <div class="page-content">
        <div class="page-header">
            <h1><span>ğŸ“„ DOCX to TXT Converter</span></h1>
            <a href="document-tools.html" class="back-button">
                <span>â† Back to Document Tools</span>
            </a>
        </div>
        
        <div class="converter-container">
            <div class="tool-header">
                <div class="tool-icon">ğŸ“„</div>
                <h2>Convert DOCX to TXT</h2>
                <p>Extract plain text content from Microsoft Word documents</p>
            </div>
            
            <!-- Upload Area -->
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“</div>
                <h3>Select or drag DOCX files here</h3>
                <p style="color: var(--text-muted); margin-top: 10px;">
                    <span>Supports .docx, .doc files</span>
                </p>
                <input type="file" id="fileInput" style="display: none;" multiple accept=".docx,.doc">
                <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()" style="margin-top: 15px;">
                    <span>Select Files</span>
                </button>
            </div>
            
            <!-- File Info -->
            <div class="file-info" id="fileInfo">
                <h3>Selected Files:</h3>
                <div id="fileDetails"></div>
            </div>
            
            <!-- Conversion Options -->
            <div class="conversion-options" id="conversionOptions">
                <h3>Conversion Options:</h3>
                <div class="options-grid">
                    <div class="option-card">
                        <label>
                            <input type="checkbox" id="preserveFormatting" checked>
                            <span>Preserve basic formatting</span>
                        </label>
                    </div>
                    <div class="option-card">
                        <label>
                            <input type="checkbox" id="includeLineBreaks" checked>
                            <span>Preserve line breaks</span>
                        </label>
                    </div>
                    <div class="option-card">
                        <label>
                            <input type="checkbox" id="removeExtraSpaces">
                            <span>Remove extra spaces</span>
                        </label>
                    </div>
                    <div class="option-card">
                        <label>
                            <input type="checkbox" id="addMetadata">
                            <span>Include document metadata</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Conversion Progress -->
            <div class="conversion-progress" id="conversionProgress">
                <h4>Conversion Progress:</h4>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div id="progressText">0%</div>
            </div>
            
            <!-- Action Buttons -->
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-primary" id="convertBtn" disabled>
                    <span>Start Conversion</span>
                </button>
                <button class="btn btn-secondary" id="clearBtn" style="margin-left: 10px;">
                    <span>Clear Files</span>
                </button>
            </div>
        </div>
        
        <!-- Conversion Results -->
        <div class="conversion-result" id="conversionResult">
            <h3>ğŸ‰ <span>Conversion Complete!</span></h3>
            <div class="result-preview" id="resultPreview">
                <!-- HTML preview will be shown here -->
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" id="downloadBtn">
                    ğŸ“¥ <span>Download TXT</span>
                </button>
                <button class="btn btn-secondary" id="shareBtn">
                    ğŸ“¤ <span>Share File</span>
                </button>
                <button class="btn btn-secondary" id="newConversionBtn">
                    ğŸ”„ <span>New Conversion</span>
                </button>
            </div>
        </div>
        
        <!-- Features Info -->
        <div class="features-info">
            <h3><span>ğŸš€ Features</span></h3>
            <div class="features-grid">
                <div class="feature-item">
                    <div class="feature-icon">ğŸ¨</div>
                    <h4>Preserve Formatting</h4>
                    <p>Maintains original document styles and layout</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">ğŸ–¼ï¸</div>
                    <h4>Image Support</h4>
                    <p>Converts embedded images to web formats</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">ğŸ“±</div>
                    <h4>Responsive Design</h4>
                    <p>Mobile-friendly HTML output</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">ğŸ”’</div>
                    <h4>Secure Processing</h4>
                    <p>All processing happens locally</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Device Selection Modal -->
    <div class="device-modal" id="deviceModal">
        <div class="device-modal-content">
            <div class="device-modal-header">
                <h3 class="device-modal-title">Select Transfer Devices</h3>
                <button class="device-modal-close" onclick="closeDeviceModal()">&times;</button>
            </div>
            <div class="device-list" id="deviceList">
                <!-- Device list will be populated here -->
            </div>
            <div class="device-modal-actions">
                <button class="modal-btn modal-btn-cancel" onclick="closeDeviceModal()">Cancel</button>
                <button class="modal-btn modal-btn-send" id="sendToDevicesBtn" onclick="sendToSelectedDevices()" disabled>
                    <span>Send to Selected Devices</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // å›½é™…åŒ–è¾…åŠ©å‡½æ•°
        function getI18nText(key) {
            if (window.DROPSHARE_I18N && typeof 
            }
            return null;
        }

        // DOMå…ƒç´ 
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileDetails = document.getElementById('fileDetails');
        const conversionOptions = document.getElementById('conversionOptions');
        const convertBtn = document.getElementById('convertBtn');
        const clearBtn = document.getElementById('clearBtn');
        const conversionProgress = document.getElementById('conversionProgress');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const conversionResult = document.getElementById('conversionResult');
        const resultPreview = document.getElementById('resultPreview');
        const downloadBtn = document.getElementById('downloadBtn');
        const shareBtn = document.getElementById('shareBtn');
        const newConversionBtn = document.getElementById('newConversionBtn');
        
        let selectedFiles = [];
        let convertedFiles = [];

        // æ–‡ä»¶æ‹–æ‹½åŠŸèƒ½
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files).filter(file => 
                file.name.toLowerCase().endsWith('.docx') || file.name.toLowerCase().endsWith('.doc')
            );
            if (files.length > 0) {
                handleFiles(files);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFiles(Array.from(e.target.files));
            }
        });

        function handleFiles(files) {
            selectedFiles = files;
            displayFileInfo();
            fileInfo.style.display = 'block';
            conversionOptions.style.display = 'block';
            convertBtn.disabled = false;
        }

        function displayFileInfo() {
            fileDetails.innerHTML = '';
            selectedFiles.forEach((file, index) => {
                const fileDiv = document.createElement('div');
                fileDiv.className = 'file-details';
                fileDiv.innerHTML = `
                    <div class="file-icon">ğŸ“„</div>
                    <div>
                        <div style="font-weight: 500;">${file.name}</div>
                        <div style="color: var(--text-muted); font-size: 0.9em;">
                            ${formatFileSize(file.size)} â€¢ ${file.type || 'DOCX Document'}
                        </div>
                    </div>
                `;
                fileDetails.appendChild(fileDiv);
            });
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // è½¬æ¢åŠŸèƒ½
        convertBtn.addEventListener('click', startConversion);
        clearBtn.addEventListener('click', clearFiles);
        newConversionBtn.addEventListener('click', clearFiles);

        async function startConversion() {
            conversionProgress.style.display = 'block';
            convertBtn.disabled = true;
            
            convertedFiles = [];
            
            for (let i = 0; i < selectedFiles.length; i++) {
                const file = selectedFiles[i];
                
                // æ›´æ–°è¿›åº¦
                const progress = Math.round(((i + 1) / selectedFiles.length) * 100);
                progressFill.style.width = progress + '%';
                progressText.textContent = `${progress}% - ${"Converting" || 'Converting'} ${file.name}`;
                
                // æ¨¡æ‹Ÿè½¬æ¢è¿‡ç¨‹
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // æ¨¡æ‹Ÿè½¬æ¢ç»“æœ
                const txtContent = await convertDocxToTxt(file);
                convertedFiles.push({
                    originalFile: file,
                    txtContent: txtContent,
                    filename: file.name.replace(/\.(docx?|doc)$/i, '.txt')
                });
            }
            
            progressText.textContent = "Conversion Complete" || 'Conversion Complete!';
            
            setTimeout(() => {
                conversionProgress.style.display = 'none';
                showConversionResult();
            }, 500);
        }

        async function convertDocxToTxt(file) {
            // è¿™é‡Œæ˜¯æ¨¡æ‹Ÿçš„è½¬æ¢é€»è¾‘
            // å®é™…é¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨çœŸå®çš„DOCXè½¬æ¢åº“
            const preserveFormatting = document.getElementById('preserveFormatting').checked;
            const includeLineBreaks = document.getElementById('includeLineBreaks').checked;
            const removeExtraSpaces = document.getElementById('removeExtraSpaces').checked;
            const addMetadata = document.getElementById('addMetadata').checked;
            
            let txtContent = '';
            
            if (addMetadata) {
                txtContent += `Document: ${file.name}\n`;
                txtContent += `File size: ${formatFileSize(file.size)}\n`;
                txtContent += `Converted on: ${new Date().toLocaleString()}\n`;
                txtContent += `Conversion options:\n`;
                txtContent += `- Preserve formatting: ${preserveFormatting ? 'Yes' : 'No'}\n`;
                txtContent += `- Include line breaks: ${includeLineBreaks ? 'Yes' : 'No'}\n`;
                txtContent += `- Remove extra spaces: ${removeExtraSpaces ? 'Yes' : 'No'}\n`;
                txtContent += '\n' + '='.repeat(50) + '\n\n';
            }
            
            // æ¨¡æ‹Ÿæ–‡æ¡£å†…å®¹æå–
            txtContent += `${file.name.replace(/\.(docx?|doc)$/i, '')}\n\n`;
            txtContent += `This is the extracted text content from ${file.name}.\n\n`;
            txtContent += `Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.\n\n`;
            txtContent += `Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\n\n`;
            
            if (preserveFormatting) {
                txtContent += `Section 1: Important Information\n`;
                txtContent += `   - Bullet point 1\n`;
                txtContent += `   - Bullet point 2\n`;
                txtContent += `   - Bullet point 3\n\n`;
            } else {
                txtContent += `Section 1: Important Information Bullet point 1 Bullet point 2 Bullet point 3\n\n`;
            }
            
            if (removeExtraSpaces) {
                txtContent = txtContent.replace(/\s+/g, ' ').replace(/\n\s+/g, '\n');
            }
            
            if (!includeLineBreaks) {
                txtContent = txtContent.replace(/\n+/g, ' ');
            }
            
            return txtContent;
        }

        function showConversionResult() {
            conversionResult.style.display = 'block';
            
            if (convertedFiles.length > 0) {
                resultPreview.innerHTML = `<pre style="white-space: pre-wrap; font-family: monospace;">${convertedFiles[0].txtContent}</pre>`;
            }
            
            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            conversionResult.scrollIntoView({ behavior: 'smooth' });
        }

        function clearFiles() {
            selectedFiles = [];
            convertedFiles = [];
            fileInput.value = '';
            fileInfo.style.display = 'none';
            conversionOptions.style.display = 'none';
            conversionProgress.style.display = 'none';
            conversionResult.style.display = 'none';
            convertBtn.disabled = true;
            progressFill.style.width = '0%';
            progressText.textContent = '0%';
        }

        // ä¸‹è½½åŠŸèƒ½
        downloadBtn.addEventListener('click', () => {
            if (convertedFiles.length === 0) return;
            
            if (convertedFiles.length === 1) {
                downloadSingleFile(convertedFiles[0]);
            } else {
                downloadAllFiles();
            }
        });

        function downloadSingleFile(fileData) {
            const blob = new Blob([fileData.txtContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileData.filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function downloadAllFiles() {
            // å¦‚æœæœ‰å¤šä¸ªæ–‡ä»¶ï¼Œåˆ›å»ºZIPä¸‹è½½
            const JSZip = window.JSZip;
            if (!JSZip) {
                // å¦‚æœæ²¡æœ‰JSZipåº“ï¼Œé€ä¸ªä¸‹è½½
                convertedFiles.forEach((fileData, index) => {
                    setTimeout(() => downloadSingleFile(fileData), index * 100);
                });
                return;
            }
            
            const zip = new JSZip();
            convertedFiles.forEach(fileData => {
                zip.file(fileData.filename, fileData.txtContent);
            });
            
            zip.generateAsync({ type: 'blob' }).then(content => {
                const url = URL.createObjectURL(content);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'converted_txt_files.zip';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        }

        // åˆ†äº«åŠŸèƒ½
        shareBtn.addEventListener('click', () => {
            if (convertedFiles.length === 0) return;
            openDeviceModal();
        });

        // è®¾å¤‡é€‰æ‹©æ¨¡æ€æ¡†åŠŸèƒ½
        let selectedDevices = new Set();

        function openDeviceModal() {
            const modal = document.getElementById('deviceModal');
            modal.style.display = 'flex';
            populateDeviceList();
        }

        function closeDeviceModal() {
            const modal = document.getElementById('deviceModal');
            modal.style.display = 'none';
            selectedDevices.clear();
            updateSendButton();
        }

        function populateDeviceList() {
            const deviceList = document.getElementById('deviceList');
            deviceList.innerHTML = '';
            
            // æ¨¡æ‹Ÿè®¾å¤‡åˆ—è¡¨
            const mockDevices = [
                { id: 'device1', name: 'iPhone 12', type: 'mobile', icon: 'ğŸ“±' },
                { id: 'device2', name: 'MacBook Pro', type: 'desktop', icon: 'ğŸ’»' },
                { id: 'device3', name: 'iPad Air', type: 'tablet', icon: 'ğŸ“±' },
                { id: 'device4', name: 'Chrome Desktop', type: 'desktop', icon: 'ğŸ–¥ï¸' }
            ];
            
            mockDevices.forEach(device => {
                const deviceItem = document.createElement('div');
                deviceItem.className = 'device-item';
                deviceItem.innerHTML = `
                    <div style="font-size: 1.5em;">${device.icon}</div>
                    <div>
                        <div style="font-weight: 500;">${device.name}</div>
                        <div style="color: var(--text-muted); font-size: 0.9em;">${device.type}</div>
                    </div>
                `;
                
                deviceItem.addEventListener('click', () => {
                    if (selectedDevices.has(device.id)) {
                        selectedDevices.delete(device.id);
                        deviceItem.classList.remove('selected');
                    } else {
                        selectedDevices.add(device.id);
                        deviceItem.classList.add('selected');
                    }
                    updateSendButton();
                });
                
                deviceList.appendChild(deviceItem);
            });
        }

        function updateSendButton() {
            const sendBtn = document.getElementById('sendToDevicesBtn');
            const span = sendBtn.querySelector('span');
            const count = selectedDevices.size;
            
            if (count === 0) {
                sendBtn.disabled = true;
                if (span) span.textContent = "Btn Send To Devices" || 'ä¼ é€åˆ°é€‰ä¸­è®¾å¤‡';
            } else {
                sendBtn.disabled = false;
                const sendToText = "Btn Send To Devices Count" || 'ä¼ é€åˆ°';
                const devicesText = "Devices" || 'ä¸ªè®¾å¤‡';
                if (span) span.textContent = `${sendToText} ${count} ${devicesText}`;
            }
        }

        function sendToSelectedDevices() {
            if (selectedDevices.size === 0) return;
            
            const deviceCount = selectedDevices.size;
            
            // è¿™é‡Œåº”è¯¥é›†æˆå®é™…çš„æ–‡ä»¶ä¼ è¾“åŠŸèƒ½
            if (window.ui && window.ui.filesQueue) {
                // å¦‚æœæœ‰ä¼ è¾“ç³»ç»Ÿï¼Œæ·»åŠ æ–‡ä»¶åˆ°é˜Ÿåˆ—
                convertedFiles.forEach(fileData => {
                    const blob = new Blob([fileData.htmlContent], { type: 'text/html' });
                    const file = new File([blob], fileData.filename, { type: 'text/html' });
                    window.ui.filesQueue.push(file);
                });
                
                alert(`æ–‡ä»¶å·²å¼€å§‹ä¼ é€åˆ° ${deviceCount} ä¸ªè®¾å¤‡ï¼`);
                closeDeviceModal();
            } else {
                // å¦‚æœä¼ è¾“ç³»ç»Ÿä¸å¯ç”¨ï¼Œæä¾›è·³è½¬é€‰é¡¹
                const confirmText = "Confirm Transfer Redirect" || 'ä¼ è¾“åŠŸèƒ½éœ€è¦è¿”å›ä¼ é€é¡µé¢ä½¿ç”¨ã€‚\n\næ˜¯å¦ç°åœ¨è·³è½¬åˆ°ä¼ é€é¡µé¢ï¼Ÿ';
                if (confirm(confirmText)) {
                    // å°†æ–‡ä»¶ä¿¡æ¯å­˜å‚¨åˆ°sessionStorageï¼Œä¾›ä¼ é€é¡µé¢ä½¿ç”¨
                    const fileInfo = convertedFiles.map(fileData => ({
                        name: fileData.filename,
                        type: 'text/html',
                        size: new Blob([fileData.htmlContent]).size,
                        content: fileData.htmlContent
                    }));
                    
                    sessionStorage.setItem('pendingFileTransfer', JSON.stringify({
                        files: fileInfo,
                        timestamp: Date.now()
                    }));
                    
                    window.location.href = 'index.html';
                }
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // åŠ è½½å›½é™…åŒ–
            if (typeof loadLanguage === 'function') {
                loadLanguage();
            }
        });
    </script>
    
    <!-- Include i18n scripts -->

    <!-- Share Integration -->
    <script src="device-selector.js"></script>
    <script src="add-share-integration.js"></script>
</body>
</html>
