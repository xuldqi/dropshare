# 修复Nixpacks构建错误

## 问题描述

构建时出现错误：
```
Error: Error reading backup/public/scripts/i18n/languages_fixed.js
Caused by: stream did not contain valid UTF-8
```

## 已完成的修复

1. ✅ 更新了 `.gitignore`，忽略所有backup相关文件
2. ✅ 创建了 `.nixpacksignore` 文件，防止Nixpacks读取backup目录

## 如果问题仍然存在

如果文件仍在Git历史中，需要从历史中彻底删除：

### 方法1: 使用git filter-repo（推荐）

```bash
# 安装git-filter-repo（如果未安装）
pip install git-filter-repo

# 从所有历史中删除backup目录
git filter-repo --path backup --invert-paths --force

# 强制推送（需要协调团队成员）
git push origin --force --all
```

### 方法2: 使用BFG Repo-Cleaner

```bash
# 下载BFG
# https://rtyley.github.io/bfg-repo-cleaner/

# 删除backup目录
java -jar bfg.jar --delete-folders backup

# 清理并推送
git reflog expire --expire=now --all
git gc --prune=now --aggressive
git push origin --force --all
```

### 方法3: 如果只是临时文件

如果这个文件不是必需的，可以：
1. 在Dokploy平台设置中配置构建忽略路径
2. 或者联系Dokploy支持，让他们在构建时忽略backup目录

## 当前状态

- ✅ `.gitignore` 已更新，忽略backup目录
- ✅ `.nixpacksignore` 已创建
- ⚠️ 如果文件在Git历史中，可能需要使用上述方法彻底删除

## 验证

重新触发部署，应该不再出现UTF-8编码错误。


