<!DOCTYPE html>
<html>
<head>
    <title>DropShare Rooms Test</title>
</head>
<body>
    <h1>Rooms Functionality Test</h1>
    <div id="status"></div>
    <button onclick="testRoomsFlow()">Test Complete Rooms Flow</button>
    
    <script src="security_utils.js"></script>
    <script src="room-debugger.js"></script>
    
    <script>
        function log(message) {
            const status = document.getElementById('status');
            status.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
            console.log(message);
        }
        
        function testRoomsFlow() {
            log('üîß Starting rooms functionality test...');
            
            // Test 1: Check if room debugger exists
            if (window.roomDebugger) {
                log('‚úÖ Room debugger found');
                
                // Test 2: Check requirements
                const requirements = window.roomDebugger.checkRoomRequirements();
                log('üìã Requirements check completed');
                
                // Test 3: Try file upload simulation
                const testFile = new File(['test content'], 'test.txt', {type: 'text/plain'});
                log('üìÅ Created test file: ' + testFile.name);
                
                // Test 4: Try manual file handling
                try {
                    window.roomDebugger.handleFileSelection([testFile])
                        .then(() => {
                            log('‚úÖ File selection handling completed');
                        })
                        .catch(error => {
                            log('‚ùå File selection failed: ' + error.message);
                        });
                } catch (error) {
                    log('‚ùå File selection error: ' + error.message);
                }
                
            } else {
                log('‚ùå Room debugger not found');
            }
            
            // Test security utils
            if (window.SecurityUtils) {
                log('‚úÖ Security utils found');
                const testName = SecurityUtils.validateFileName('test.txt');
                log('üîí File name validation: ' + testName);
            } else {
                log('‚ùå Security utils not found');
            }
        }
    </script>
</body>
</html>